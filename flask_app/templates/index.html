<!DOCTYPE html>
<html>
<head>
    <title>Hue Lights Control</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='main.css') }}">
    <script>
        function toggleLight(lightId) {
            fetch(`/toggle/${lightId}`)
                .then(response => {
                    if (response.ok) {
                        return fetchLights();
                    }
                })
                .catch(error => console.error('Error:', error));
        }

        function fetchLights() {
            fetch('/lights')
                .then(response => response.json())
                .then(data => {
                    const lightsList = document.getElementById('lights-list');
                    lightsList.innerHTML = '';
                    for (const lightId in data) {
                        const light = data[lightId];
                        const li = document.createElement('li');
                        li.innerHTML = `<a href="javascript:toggleLight(${lightId})">${light.name}: ${light.on ? 'On' : 'Off'}</a>`;
                        lightsList.appendChild(li);
                    }
                })
                .catch(error => console.error('Error:', error));
        }

        document.addEventListener('DOMContentLoaded', (event) => {
            fetchLights();
        });
    </script>
</head>
<body>
    <h1>Hue Lights</h1>
    <ul id="lights-list">
        <!-- Lights will be loaded here by JavaScript -->
    </ul>
    <a href="/automations">Automations</a>
</body>
</html>
